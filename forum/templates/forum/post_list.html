{% extends "base.html" %}

{% block title %}Posts{% endblock %}

{% block content %}
<div class="container mt-4">

    <h1>Posts</h1>

    {% if not user.is_authenticated %}
    <p>You must be logged in to create a post.</p>
    {% else %}
    {% if user.is_authenticated and is_approved %}

    <a href="{% url 'create_post' %}" class="btn btn-primary mb-3">Create Post</a>



    {% for post in posts %}
    <a href="{% url 'post_detail' post.id %}" class="post-card">
        <div class="card mb-1 post-card">
            <div class="card-body">
                <h5 class="card-title">{{ post.title }}</h5>
                <!-- Display the first 30 characters of the content  -->
                <p>{{ post.content|truncatechars:100|safe }}</p>

                {% if user.is_authenticated and user == post.author %}
                <a href="{% url 'edit_post' post.id %}" class="btn btn-sm btn-primary">Edit</a>
                <a href="{% url 'delete_post' post.id %}" class="btn btn-sm btn-danger">Delete</a>
                {% endif %}

            </div>
            <div class="d-flex justify-content-between align-items-center">
                <!-- Like Button -->
                <button type="button" class="custom-secondary-btn btn btn-outline-primary">
                    <i class="fas fa-thumbs-up"></i> Like
                </button>
                <!-- Like Counter -->
                <span class="text-muted"><i class="far fa-thumbs-up"></i> 10</span>

                <!-- Comment Button -->
                <button type="button" class="comment-btn custom-secondary-btn btn-outline-secondary rounded py-1">
                    <i class="fas fa-comment"></i> Comment
                </button>
                <!-- Comment Counter -->
                <span class="text-muted"><i class="far fa-comment"></i> 5</span>

                <!-- Favorite Button -->
                <button type="button" class="favorite-btn btn btn-outline-danger">
                    <i class="fas fa-heart"></i> Favourite
                </button>
                <!-- Favorite Counter -->
                <span class="text-muted"><i class="far fa-heart"></i> 7</span>
            </div>

        </div>
    </a>

    {% empty %}
    <li>No posts found matching your life stage or neurodiversity</li>
    {% endfor %}


    {% else %}
    <p>Your account is awaiting approval. You cannot create a post until your account is approved.</p>
    {% endif %}
    {% endif %}

</div>
{% endblock %}